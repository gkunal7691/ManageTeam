<div class="content-heading">
  <div class="col">
    All Users
    <small>View and search for Admins and Employees throughout the Organization.</small>
  </div>
  <div class="col pr-0">
    <button class="btn btn-primary float-right" data-toggle="modal" data-target=".addUserModal" (click)="formReset()">
      Add Another User
    </button>
  </div>
</div>

<!-- Add User Modal -->

<div class="modal fade addUserModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog  modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header pb-0">
        <h4 class="modal-title">{{modalTitle}} :</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="formReset()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <div class="row">
            <div class="col pl-2 pr-0">
              <div class="row">
                <div class="col-4 mt-2">
                  <label>First Name :</label>
                </div>
                <div class="col-7">
                  <input class="form-control mb-1" type="text" [formControl]="addUserForm.controls['firstName']">
                  <span class="text-danger" *ngIf="addUserForm.controls['firstName'].invalid &&
                    addUserForm.controls['firstName'].touched">
                    <i>Invalid first name entered.</i>
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Last Name :</label>
                </div>
                <div class="col-7">
                  <input class="form-control mb-1" type="text" [formControl]="addUserForm.controls['lastName']">
                  <span class="text-danger" *ngIf="addUserForm.controls['lastName'].invalid &&
                    addUserForm.controls['lastName'].touched">
                    <i>Invalid last name entered.</i>
                  </span>
                </div>
              </div>

              <div class="dropdown row">
                <div class="col-4 mt-2">
                  <label>Role :</label>
                </div>
                <div class="col-7">
                  <select class="form-control mb-1" [formControl]="addUserForm.controls['roleId']">
                    <option [selected]="true" value="">Select</option>
                    <option value="1">Employee</option>
                    <option value="2">Admin/Manager</option>
                    <option value="3">Super Admin</option>
                  </select>
                  <span class="text-danger" *ngIf="addUserForm.controls['roleId'].invalid &&
                    addUserForm.controls['roleId'].touched">
                    <i>Selected Role is invalid.</i>
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Designation :</label>
                </div>
                <div class="col-7">
                  <select class="form-control mb-1" [formControl]="addUserInfoForm.controls['desg']">
                    <option [selected]="true" value="">Select</option>
                    <option value="Associate Software Developer">Associate Software Developer</option>
                    <option value="Software Developer">Software Developer</option>
                    <option value="Senior Software Developer">Senior Software Developer</option>
                    <option value="Team Leader">Team Leader</option>
                    <option value="Manager">Manager</option>
                  </select>
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['desg'].invalid &&
                    addUserInfoForm.controls['desg'].touched">
                    <i>Selected an Invalid Designation.</i>
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Email :</label>
                </div>
                <div class="col-7">
                  <input class="form-control mb-1" type="email" [formControl]="addUserForm.controls['email']" />
                  <span class="text-danger" *ngIf="addUserForm.controls['email'].invalid &&
                    addUserForm.controls['email'].touched">
                    Invalid email entered.
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Secondary email :</label>
                </div>
                <div class="col-7">
                  <input class="form-control mb-1" type="email" [formControl]="addUserInfoForm.controls['secEmail']" />
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['secEmail'].invalid &&
                    addUserInfoForm.controls['secEmail'].touched">
                    Invalid email entered.
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Password :</label>
                </div>
                <div class="col-7">
                  <input class="form-control mb-1" type="password" [formControl]="addUserForm.controls['password']">
                  <span class="text-danger" *ngIf="addUserForm.controls['password'].invalid &&
                    addUserForm.controls['password'].touched">
                    <i>Invalid email entered.</i>
                  </span>
                </div>
              </div>

              <div class="row">
                <div class="col-4 mt-2">
                  <label>Current Address :</label>
                </div>
                <div class="col-7">
                  <textarea class="form-control pb-0" rows="3"
                    [formControl]="addUserInfoForm.controls['tempAddress']"></textarea>
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['tempAddress'].invalid &&
                    addUserInfoForm.controls['tempAddress'].touched">
                    <i>Invalid Current Address entered.</i>
                  </span>
                </div>
              </div>

            </div>
            <div class="col pl-0 pr-0">
              <div class="row">
                <div class="col-4">
                  <label>Mobile : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['mobile']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['mobile'].invalid &&
                    addUserInfoForm.controls['mobile'].touched">
                    <i>Invalid Mobile Number entered.</i>
                  </span>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-4">
                  <label>Bank Name : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['bank']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['bank'].invalid &&
                    addUserInfoForm.controls['bank'].touched">
                    <i>Invalid Bank Name.</i>
                  </span>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-4">
                  <label>Account Number : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['banknumber']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['banknumber'].invalid &&
                    addUserInfoForm.controls['banknumber'].touched">
                    <i>Invalid Account Number.</i>
                  </span>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-4">
                  <label>Date of Joining : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['doj']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['doj'].invalid &&
                    addUserInfoForm.controls['doj'].touched">
                    <i>Invalid Account Number.</i>
                  </span>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-4">
                  <label>PF Number : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['pf']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['pf'].invalid &&
                    addUserInfoForm.controls['pf'].touched">
                    <i>Invalid Provident Fund Number.</i>
                  </span>
                </div>
              </div>
              <div class="row mt-1">
                <div class="col-4">
                  <label>Location : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['location']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['location'].invalid &&
                    addUserInfoForm.controls['location'].touched">
                    <i>Invalid Location.</i>
                  </span>
                </div>
              </div>

              <div class="row mt-1">
                <div class="col-4">
                  <label>Department : </label>
                </div>
                <div class="col-7">
                  <input class="form-control" type="text" [formControl]="addUserInfoForm.controls['dept']">
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['dept'].invalid &&
                    addUserInfoForm.controls['dept'].touched">
                    <i>Invalid Department.</i>
                  </span>
                </div>
              </div>

              <div class="row mt-1">
                <div class="col-4 mt-2 pr-0">
                  <label>Permanent Address :</label>
                </div>
                <div class="col-7">
                  <textarea class="form-control pb-0" rows="3"
                    [formControl]="addUserInfoForm.controls['permanentAddress']"></textarea>
                  <span class="text-danger" *ngIf="addUserInfoForm.controls['permanentAddress'].invalid &&
                    addUserInfoForm.controls['permanentAddress'].touched">
                    <i>Invalid Current Permanent entered.</i>
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-warning" data-dismiss="modal" aria-label="Close"
          (click)="formReset()">Cancel
        </button>
        <button type="button" class="btn btn-primary" [disabled]="addUserForm.invalid || addUserInfoForm.invalid"
          data-dismiss="modal" aria-label="Save" (click)="createUser()">Save
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Material Table -->

<div class="container-fluid">
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="col-8">
          <mat-form-field class="w-50">
            <input matInput (keyup)="search($event.target.value)" placeholder="Search">
          </mat-form-field>
        </div>
      </div>
      <div class="card card-default">
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
            <td mat-cell *matCellDef="let employeeList">{{employeeList?.id}} </td>
          </ng-container>

          <ng-container matColumnDef="user">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Users</th>
            <td mat-cell *matCellDef="let employeeList">
              {{employeeList?.firstName}} {{employeeList?.lastName}} ({{employeeList?.email}})</td>
          </ng-container>

          <ng-container matColumnDef="roleId">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Role</th>
            <td mat-cell *matCellDef="let employeeList">
              {{employeeList?.roleId}}
            </td>
          </ng-container>

          <ng-container matColumnDef="lastLogin">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Last Login</th>
            <td mat-cell *matCellDef="let employeeList">{{employeeList?.lastLogin | date:longDate}}</td>
          </ng-container>

          <ng-container matColumnDef="action" style="text-align: center;">
            <th mat-header-cell *matHeaderCellDef mat-sort-header Sty>Action</th>
            <td mat-cell *matCellDef="let employeeList" style="display: flex;justify-content: space-evenly;">
              <button title="Edit Information" class="btn btn-warning" data-toggle="modal" data-target=".addUserModal"
                [disabled]="employeeList.roleId != 'Employee'" (click)="updateFormForEdit(employeeList)">
                <em class="icon-pencil"></em>
              </button>
              <button title="View Information" class="btn btn-success" [disabled]="employeeList.roleId != 'Employee'"
                (click)="onViewClick(employeeList)">
                <em class="fas fa-eye"></em>
              </button>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
      <mat-paginator [pageSizeOptions]="[10, 20, 30]" showFirstLastButtons></mat-paginator>
    </div>
  </div>
</div>